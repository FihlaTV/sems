From 25d1e08a30a4c3e2ef44e2605a7f7dc900075da0 Mon Sep 17 00:00:00 2001
From: Stefan Sayer <stefan.sayer@googlemail.com>
Date: Fri, 10 Jun 2011 14:21:35 +0200
Subject: [PATCH] db_reg_agent: removed adding colon iof query in the code

---
 apps/db_reg_agent/DBRegAgent.cpp        |    2 +-
 apps/db_reg_agent/etc/db_reg_agent.conf |    5 ++---
 2 files changed, 3 insertions(+), 4 deletions(-)

diff --git a/apps/db_reg_agent/DBRegAgent.cpp b/apps/db_reg_agent/DBRegAgent.cpp
index f2fbac0..71c486a 100644
--- a/apps/db_reg_agent/DBRegAgent.cpp
+++ b/apps/db_reg_agent/DBRegAgent.cpp
@@ -237,7 +237,7 @@ bool DBRegAgent::loadRegistrations() {
 
     string query_string, table;
 
-    query_string = joined_query + ";";
+    query_string = joined_query;
 
     DBG("querying all registrations with : '%s'\n",
 	query_string.c_str());
diff --git a/apps/db_reg_agent/etc/db_reg_agent.conf b/apps/db_reg_agent/etc/db_reg_agent.conf
index f330efe..7f43a59 100644
--- a/apps/db_reg_agent/etc/db_reg_agent.conf
+++ b/apps/db_reg_agent/etc/db_reg_agent.conf
@@ -13,11 +13,10 @@ mysql_passwd=mypass123
 # registrations_table="registrations"
 
 # query joining subscriber info with registration table
-# (without trailing ';' such that where clause can appended)
-joined_query="select subscribers.subscriber_id as subscriber_id, subscribers.user as user, subscribers.pass as pass, subscribers.realm as realm, registrations.registration_status as registration_status, registrations.expiry as expiry, registrations.last_registration as last_registration from subscribers left join registrations on subscribers.subscriber_id=registrations.subscriber_id"
+joined_query="select subscribers.subscriber_id as subscriber_id, subscribers.user as user, subscribers.pass as pass, subscribers.realm as realm, registrations.registration_status as registration_status, registrations.expiry as expiry, registrations.last_registration as last_registration from subscribers left join registrations on subscribers.subscriber_id=registrations.subscriber_id;"
 
 #example with contact:
-# joined_query="select subscribers.subscriber_id as subscriber_id, subscribers.user as user, subscribers.pass as pass, subscribers.realm as realm, subscribers.contact as contact, registrations.registration_status as registration_status, registrations.expiry as expiry, registrations.last_registration as last_registration from subscribers left join registrations on subscribers.subscriber_id=registrations.subscriber_id"
+# joined_query="select subscribers.subscriber_id as subscriber_id, subscribers.user as user, subscribers.pass as pass, subscribers.realm as realm, subscribers.contact as contact, registrations.registration_status as registration_status, registrations.expiry as expiry, registrations.last_registration as last_registration from subscribers left join registrations on subscribers.subscriber_id=registrations.subscriber_id;"
 
 # contact_hostport=<host:port> - overriding contact host:port
 # sets the contact host:port portion that is registered
-- 
1.7.10.4

