From 3930ca276eb1275304e1f52e4ef6d8e3d820b7a7 Mon Sep 17 00:00:00 2001
From: Stefan Sayer <stefan.sayer@googlemail.com>
Date: Mon, 15 Jul 2013 12:47:43 +0200
Subject: [PATCH] sbc: b/f: reply 100 Trying to in-dlg msgs which are to be
 relayed

Conflicts:

	apps/sbc/SBC.cpp
---
 apps/sbc/SBC.cpp    |   10 ++++++++++
 core/AmSipHeaders.h |    1 +
 2 files changed, 11 insertions(+)

diff --git a/apps/sbc/SBC.cpp b/apps/sbc/SBC.cpp
index d6245a6..4b2bc5d 100644
--- a/apps/sbc/SBC.cpp
+++ b/apps/sbc/SBC.cpp
@@ -858,6 +858,11 @@ void SBCDialog::onSipRequest(const AmSipRequest& req) {
     }
   }
 
+  if (fwd) {
+      DBG("replying 100 Trying of %s msg to be fwd'ed\n", req.method.c_str());
+      dlg.reply(req, 100, SIP_REPLY_TRYING);
+  }
+
   AmB2BCallerSession::onSipRequest(req);
 }
 
@@ -1221,6 +1226,11 @@ void SBCCalleeSession::onSipRequest(const AmSipRequest& req) {
     }
   }
 
+  if (fwd) {
+      DBG("replying 100 Trying of %s msg to be fwd'ed\n", req.method.c_str());
+      dlg.reply(req, 100, SIP_REPLY_TRYING);
+  }
+
   AmB2BCalleeSession::onSipRequest(req);
 }
 
diff --git a/core/AmSipHeaders.h b/core/AmSipHeaders.h
index 911a3a4..78b39c3 100644
--- a/core/AmSipHeaders.h
+++ b/core/AmSipHeaders.h
@@ -62,5 +62,6 @@
 #define SIP_REPLY_EXTENSION_REQUIRED    "Extension Required"
 #define SIP_REPLY_LOOP_DETECTED         "Loop Detected"
 #define SIP_REPLY_NOT_EXIST             "Call Leg/Transaction Does Not Exist"
+#define SIP_REPLY_TRYING                "Trying"
 
 #endif /* __AMSIPHEADERS_H__ */
-- 
1.7.10.4

